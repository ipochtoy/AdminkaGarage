# AdminkaGarage - Статус проекта

**Дата обновления:** 23 ноября 2025

## Описание
Laravel + Filament админка для управления товарами e-commerce с AI-функциями.

## Стек технологий
- Laravel 12
- Filament 3
- Livewire + Alpine.js
- MySQL
- Telegram Bot API

---

## Реализованные функции

### 1. Управление фото
- **Telegram Bot** - загрузка фото через Telegram с сохранением EXIF
- **Bulk Upload** - веб-интерфейс для загрузки папок с фильтром по дате
- **Галерея фото** - просмотр, поворот, удаление, выбор главного фото
- **Lightbox** - увеличение по клику

### 2. AI интеграция

#### Генерация описаний
- **OpenAI GPT-5.1** - генерация описаний товаров
- **Gemini 3 Pro Preview** - альтернативный AI провайдер
- Автозаполнение: название, описание, бренд, категория, размер, цвет, состояние, цена

#### Обработка изображений (FASHN API)
- **Кнопка FASHN** - генерация модели в одежде
  - Рандомные модели (определение пола по названию)
  - Рандомные фоны
  - Удаление ценников
- **Кнопка Magic** - замена фона на студийный/градиент
  - Сохраняет состояние товара
  - Убирает вешалки и бирки

### 3. Рекомендации по цене
- Поиск цен на eBay
- Показ похожих товаров с ценами
- Рекомендуемый диапазон цен

### 4. Сканирование баркодов
- Выделение GG лейблов (оранжевым)
- Сохранение баркодов при удалении фото (перенос на другие фото)

### 5. Предпросмотр товара
- Модальное окно с данными из формы
- Поддержка темной темы

### 6. Голосовые правки (В процессе)
- Web Speech API для голосового ввода
- AI переписывает на основе правок
- Автообновление полей формы

---

## Ключевые сервисы

| Сервис | Назначение |
|--------|------------|
| `GeminiService` | Gemini API для описаний |
| `AIService` | Интеграция OpenAI |
| `FashnService` | FASHN AI для генерации изображений |
| `EbayService` | Поиск цен |
| `UPCService` | Поиск по баркодам |

---

## Конфигурация

### Переменные окружения (.env)
```
TELEGRAM_BOT_TOKEN=xxx
FASHN_API_KEY=xxx
GEMINI_API_KEY=xxx
OPENAI_API_KEY=xxx
```

### Запуск бота
```bash
php artisan telegram:bot
```

### Запуск приложения
```bash
php artisan serve
```

Админка: http://localhost:8000/admin

---

## Изменения 23 ноября 2025

1. FASHN API интеграция с индикаторами загрузки
2. Кнопка Magic для замены фона
3. Lightbox для фото
4. Предпросмотр товара с данными формы
5. Сохранение баркодов при удалении фото
6. Компонент голосовых правок (UI готов)
7. Исправлен CSRF токен для bulk upload
8. Увеличен таймаут Gemini до 120сек
9. Коллапсируемый AI результат

---

## Структура файлов

```
app/
├── Console/Commands/
│   └── TelegramBotCommand.php      # Telegram бот
├── Filament/
│   ├── Resources/
│   │   ├── PhotoBatchResource.php  # Основной ресурс товаров
│   │   └── PhotoBatchResource/Pages/
│   │       └── EditPhotoBatch.php  # Страница редактирования
│   └── Pages/
│       └── BulkUpload.php          # Массовая загрузка
├── Services/
│   ├── GeminiService.php           # Gemini AI
│   ├── AIService.php               # OpenAI
│   ├── FashnService.php            # FASHN image AI
│   └── EbayService.php             # Цены eBay
└── Http/Controllers/Api/
    └── VoiceCorrectionController.php

resources/views/filament/
├── forms/components/
│   ├── photo-gallery.blade.php     # Галерея фото
│   ├── product-preview.blade.php   # Предпросмотр
│   ├── price-suggestions.blade.php # Цены eBay
│   └── voice-correction.blade.php  # Голосовой ввод
└── pages/
    └── bulk-upload.blade.php       # UI массовой загрузки
```

---

## TODO

- [ ] Завершить обработку голосовых правок через AI
- [ ] Добавить больше AI провайдеров
- [ ] Улучшить точность сканирования баркодов
- [ ] Добавить пакетные операции
- [ ] Экспорт на маркетплейсы

---

## Заметки

- Генерация FASHN занимает 1-2 минуты
- Таймаут Gemini 120 секунд для анализа изображений
- Фото хранятся в `storage/app/public/`
- Бот работает в режиме long polling
